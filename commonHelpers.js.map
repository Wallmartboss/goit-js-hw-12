{"version":3,"file":"commonHelpers.js","sources":["../src/js/pixabay-api.js","../src/js/render-functions.js","../src/main.js"],"sourcesContent":["import axios from \"axios\";\n\nexport async function pixabayRequest(userData, qtyOnPage, page) {\n  try {\n    const searchParams = {\n      params: {\n        page,\n        _per_page: qtyOnPage,\n      }\n    };\nconst searchUrl = `https://pixabay.com/api/?key=43769580-78f5aea5f54664bb89b2b40f7&q=${userData}&image_type=photo&orientation=horizontal&safesearch=true&`;\n\n    const { data } = await axios.get(searchUrl, searchParams);\n    return data; \n  } catch (error) {\n    console.log(\"Виникла помилка:\", error);\n    throw error;\n  }\n}","\nexport function markupGallery(response, gallery, qtyOnPage) {\n  let images = [];\n  for (let i = 0; i < qtyOnPage; i++) {\n                   let pic = {};\n                    pic.url = response.hits[i].webformatURL;\n                    pic.largeUrl = response.hits[i].largeImageURL;\n                    pic.tags = response.hits[i].tags;\n                    pic.likes = response.hits[i].likes;\n                    pic.views = response.hits[i].views;\n                    pic.comments = response.hits[i].comments;\n                    pic.downloads = response.hits[i].downloads;\n                    images.push(pic);\n                }\n            \n                const createElGallery = image => {\n                    return `<li class=\"gallery-item\">\n              <a class=\"gallery-link\" href=\"${image.largeUrl}\">\n                <img class=\"gallery-image\"\n                  src=\"${image.url}\"\n                  alt=\"${image.tags}\"\n                />\n              </a>\n              <div class=\"item-info\">\n                <div class=\"item-data\">\n                  <p class=\"item-param\">Likes</p>\n                  <p class=\"item-counter\">${image.likes}</p>\n                </div>\n                <div class=\"item-data\">\n                  <p class=\"item-param\">Views</p>\n                  <p class=\"item-counter\">${image.views}</p>\n                </div>\n                <div class=\"item-data\">\n                  <p class=\"item-param\">Comments</p>\n                  <p class=\"item-counter\">${image.comments}</p>\n                </div>\n                <div class=\"item-data\">\n                  <p class=\"item-param\">Downloads</p>\n                  <p class=\"item-counter\">${image.downloads}</p>\n                </div>\n              </div>\n            </li>`;\n  };\n               const createGallery = images.map(image => createElGallery(image)).join('');\n\n                gallery.insertAdjacentHTML(\"beforeend\", createGallery);\n};\n\n","import SimpleLightbox from 'simplelightbox';\nimport 'simplelightbox/dist/simple-lightbox.min.css';\nimport iziToast from \"izitoast\";\nimport \"izitoast/dist/css/iziToast.min.css\";\n\nimport { pixabayRequest } from './js/pixabay-api';\nimport { markupGallery } from './js/render-functions';\n\nconst form = document.querySelector('.search-form');\nconst input = form.querySelector('input');\nlet userData;\nconst gallery = document.querySelector('ul.gallery');\nconst loader = document.querySelector('.loader');\nconst moreBnt = document.querySelector('.load-more-btn');\nconst qtyOnPage = 15;\nlet page = 1;\nlet totalPages = 0;\nlet lightbox = new SimpleLightbox('.gallery a', {captionsData: 'alt'});\n\nfunction showLoader() {\n  loader.classList.remove('is-hidden');\n};\n\nfunction hideLoader() {\n  loader.classList.add('is-hidden');\n};\n\nfunction showButton() {\n  moreBnt.classList.remove('is-hidden');\n};\n\nfunction hideButton() {\n  moreBnt.classList.add('is-hidden');\n};\nasync function handleSubmit(event) {\n  event.preventDefault();\n\n  const textInput = input.value.trim();\n\n  if (!textInput) {\n    iziToast.warning({\n      title: 'Caution',\n      message: 'This field must be filled in',\n      position: 'topLeft',\n    })\n  } else {\n    userData = textInput;\n    form.reset();\n    gallery.innerHTML = \"\";\n    showLoader();\n    try {\n      const response = await pixabayRequest(userData, qtyOnPage, page);\n      hideLoader();\n      if (!response.totalHits) {\n        return iziToast.error({\n          title: 'Error',\n          message: `Sorry, there are no images matching your search query. Please try again!`,\n          position: 'topRight',\n        })\n      } else {\n        totalPages = Math.ceil(response.totalHits / qtyOnPage);\n        markupGallery(response, gallery, qtyOnPage);\n        lightbox.refresh();\n        if (totalPages > 1) {\n          showButton()\n        };\n      }\n    }\n     catch(error) {\n        console.error('Виникла помилка: ', error);\n      };\n  };\n  };\n  \n              \nasync function loadMore() {\n  page += 1;\n            try {\n             const response = await pixabayRequest(userData, qtyOnPage, page);\n              markupGallery(response, gallery, qtyOnPage);\n              lightbox.refresh();\n              const rect = document.querySelector('ul.gallery').firstElementChild.getBoundingClientRect();\n              const cardHeight = rect.height;\n              window.scrollBy({\n                top: 2 * cardHeight,\n                behavior: \"smooth\",\n              });\n                if (page > totalPages) {\n                hideButton();\n                return iziToast.error({\n                  position: \"topRight\",\n                  message: \"We're sorry, but you've reached the end of search results.\"\n                });\n              }\n              }\n              catch (error) {\n                console.log(error);\n              }\n            };\n          \nform.addEventListener(\"submit\", handleSubmit);\nmoreBnt.addEventListener(\"click\", loadMore);\n\n"],"names":["pixabayRequest","userData","qtyOnPage","page","searchParams","searchUrl","data","axios","error","markupGallery","response","gallery","images","i","pic","createElGallery","image","createGallery","form","input","loader","moreBnt","totalPages","lightbox","SimpleLightbox","showLoader","hideLoader","showButton","hideButton","handleSubmit","event","textInput","iziToast","loadMore","cardHeight"],"mappings":"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"}