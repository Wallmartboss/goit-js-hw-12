{"version":3,"file":"commonHelpers.js","sources":["../src/js/pixabay-api.js","../src/js/render-functions.js","../src/main.js"],"sourcesContent":["import axios from \"axios\";\n\nexport async function pixabayRequest(userData, qtyOnPage, page) {\n  try {\n    const searchParams = {\n      params: {\n        page,\n        per_page: qtyOnPage,\n      }\n    };\nconst searchUrl = `https://pixabay.com/api/?key=43769580-78f5aea5f54664bb89b2b40f7&q=${userData}&image_type=photo&orientation=horizontal&safesearch=true&`;\n\n    const { data } = await axios.get(searchUrl, searchParams);\n    return data; \n  } catch (error) {\n    console.log(\"Виникла помилка:\", error);\n    throw error;\n  }\n}","\nexport function markupGallery(response, gallery, onPage) {\n  let images = [];\n  for (let i = 0; i < onPage; i++) {\n                   let pic = {};\n                    pic.url = response.hits[i].webformatURL;\n                    pic.largeUrl = response.hits[i].largeImageURL;\n                    pic.tags = response.hits[i].tags;\n                    pic.likes = response.hits[i].likes;\n                    pic.views = response.hits[i].views;\n                    pic.comments = response.hits[i].comments;\n                    pic.downloads = response.hits[i].downloads;\n                    images.push(pic);\n                }\n            \n                const createElGallery = image => {\n                    return `<li class=\"gallery-item\">\n              <a class=\"gallery-link\" href=\"${image.largeUrl}\">\n                <img class=\"gallery-image\"\n                  src=\"${image.url}\"\n                  alt=\"${image.tags}\"\n                />\n              </a>\n              <div class=\"item-info\">\n                <div class=\"item-data\">\n                  <p class=\"item-param\">Likes</p>\n                  <p class=\"item-counter\">${image.likes}</p>\n                </div>\n                <div class=\"item-data\">\n                  <p class=\"item-param\">Views</p>\n                  <p class=\"item-counter\">${image.views}</p>\n                </div>\n                <div class=\"item-data\">\n                  <p class=\"item-param\">Comments</p>\n                  <p class=\"item-counter\">${image.comments}</p>\n                </div>\n                <div class=\"item-data\">\n                  <p class=\"item-param\">Downloads</p>\n                  <p class=\"item-counter\">${image.downloads}</p>\n                </div>\n              </div>\n            </li>`;\n  };\n               const createGallery = images.map(image => createElGallery(image)).join('');\n\n                gallery.insertAdjacentHTML(\"beforeend\", createGallery);\n};\n\n","import SimpleLightbox from 'simplelightbox';\nimport 'simplelightbox/dist/simple-lightbox.min.css';\nimport iziToast from \"izitoast\";\nimport \"izitoast/dist/css/iziToast.min.css\";\n\nimport { pixabayRequest } from './js/pixabay-api';\nimport { markupGallery } from './js/render-functions';\n\nconst form = document.querySelector('.search-form');\nconst input = form.querySelector('input');\nlet userData;\nconst gallery = document.querySelector('ul.gallery');\nconst loader = document.querySelector('.loader');\nconst moreBnt = document.querySelector('.load-more-btn');\nconst qtyOnPage = 15;\nlet page = 1;\nlet totalPages = 0;\nlet lightbox = new SimpleLightbox('.gallery a', {captionsData: 'alt'});\nlet onPage = qtyOnPage;\n\nfunction showLoader() {\n  loader.classList.remove('is-hidden');\n};\n\nfunction hideLoader() {\n  loader.classList.add('is-hidden');\n};\n\nfunction showButton() {\n  moreBnt.classList.remove('is-hidden');\n};\n\nfunction hideButton() {\n  moreBnt.classList.add('is-hidden');\n};\nasync function handleSubmit(event) {\n  event.preventDefault();\n\n  const textInput = input.value.trim();\n\n  if (!textInput) {\n    iziToast.warning({\n      title: 'Caution',\n      message: 'This field must be filled in',\n      position: 'topLeft',\n    })\n  } else {\n    userData = textInput;\n    // Скидаємо результати попередніх запитів\n    form.reset();\n    page = 1;\n    onPage = qtyOnPage;\n    gallery.innerHTML = \"\";\n    showLoader();\n    try {\n      const response = await pixabayRequest(userData, qtyOnPage, page);\n      hideLoader();\n      iziToast.info({\n       title: 'Hello',\n        message: `Found ${response.totalHits} images`,\n        position: 'topCenter',\n      });\n      if (!response.totalHits) {\n        return iziToast.error({\n          title: 'Error',\n          message: `Sorry, there are no images matching your search query. Please try again!`,\n          position: 'topRight',\n        })\n      } else {\n        totalPages = Math.ceil(response.totalHits / qtyOnPage);\n        // У випадку, коли результатів менше 15, коригуємо розмітку \n        if (page === totalPages) {\n          onPage = (response.totalHits - qtyOnPage * (page - 1));\n        };\n        markupGallery(response, gallery, onPage);\n        lightbox.refresh();\n        if (totalPages > 1) {\n          showButton()\n        };\n      }\n    }\n     catch(error) {\n        console.error('Виникла помилка: ', error);\n      };\n  };\n  };\n  \n              \nasync function loadMore() {\n  page += 1;\n              try {\n                if (page > totalPages) {\n                  hideButton();\n                  return iziToast.error({\n                    position: \"topRight\",\n                    message: \"We're sorry, but you've reached the end of search results.\"\n                  });\n                } else {\n                  const response = await pixabayRequest(userData, qtyOnPage, page);\n                  if (page === totalPages) {\n                    onPage = (response.totalHits - qtyOnPage * (page - 1));\n                  };\n                  markupGallery(response, gallery, onPage);\n                  lightbox.refresh();\n                  // Визначаємо висоту картки та встановлюємо розмір прокрутки в 2 картки\n                  const rect = document.querySelector('ul.gallery').firstElementChild.getBoundingClientRect();\n                  const scrollUp = rect.height * 2;\n                  // додаємо прокрутку із затримкою на розмітку \n                  setTimeout(function () {\n                    window.scrollBy({\n                      top: scrollUp, // Прокручуємо вниз на 2 зображення\n                      behavior: 'smooth' // Добавляємо плавності прокрутці\n                    });\n                  }, 400);  \n                };\n              }\n              catch (error) {\n                console.log(error);\n              }\n            };\n          \nform.addEventListener(\"submit\", handleSubmit);\nmoreBnt.addEventListener(\"click\", loadMore);\n\n"],"names":["pixabayRequest","userData","qtyOnPage","page","searchParams","searchUrl","data","axios","error","markupGallery","response","gallery","onPage","images","i","pic","createElGallery","image","createGallery","form","input","loader","moreBnt","totalPages","lightbox","SimpleLightbox","showLoader","hideLoader","showButton","hideButton","handleSubmit","event","textInput","iziToast","loadMore","scrollUp"],"mappings":"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"}